<!doctype html>

<html>
  <head>
    <style>
      * {
        box-sizing: border-box;
      }
      html, body {
        width: Calc(30px * 5);
        height: Calc(30px * 5);
        padding: 0;
        margin: 0;
      }
      iframe {
        border: 0.5px solid black;
        overflow: hidden;
      }
      iframe {
        opacity: 0.5;
      }
      iframe.pixel {
        width: 30px;
        height: 30px;
        
        -ms-zoom: 0.75;
        -moz-transform: scale(0.75);
        -moz-transform-origin: 0 0;
        -o-transform: scale(0.75);
        -o-transform-origin: 0 0;
        -webkit-transform: scale(1);
        -webkit-transform-origin: 0 0;
      }
    </style>
  </head>
  <body>
  
    <script>
      var TARGET_ELEMENT = (function() {
        var el = document.createElement("div");
        document.body.appendChild(el);
        return el;
      }());
      var height = width = 5,
          ndups = 0;
      
      function frameType(doc, head, body) {
          return { doc: doc, head: head, body: body };
        }
      
      var iframe = document.createElement("iframe");
      iframe.src = "black.html";
      iframe.style.display = "none";
      //iframe.style.opacity = 0;
      TARGET_ELEMENT.appendChild(iframe);
      on_load(iframe, function() {
        for (var x = 0; x < width; x++) {
          for (var y = 0; y < height; y++) {
            var duplicateFrame = duplicate(iframe, function(theFrameType) {
              var uniqueID = (ndups++) + ": [" + x + ", " + y + "]",
                idEl = theFrameType.doc.createElement("p");
            idEl.innerText = uniqueID;
            theFrameType.body.appendChild(idEl);
            });
                
            TARGET_ELEMENT.appendChild(duplicateFrame);
          }
        }
      });
      function duplicate(iframe, callback) {
        function frameType(doc, head, body) {
          return { doc: doc, head: head, body: body };
        }
        var srcFrame = frameType(),
            destFrame = frameType();
        var frameDuplicate = document.createElement("iframe");
        frameDuplicate.src = "about:blank";
        frameDuplicate.classList.add("pixel");
        frameDuplicate.setAttribute("seamless", "seamless");
        frameDuplicate.setAttribute("scrolling", "no");
        on_load(frameDuplicate, function() {
          srcFrame.doc = iframe.contentWindow.document;
          srcFrame.head = srcFrame.doc.getElementsByTagName("head")[0];
          srcFrame.body = srcFrame.doc.getElementsByTagName("body")[0];
          destFrame.doc = frameDuplicate.contentWindow.document;
          destFrame.head = destFrame.doc.getElementsByTagName("head")[0];
          destFrame.body = destFrame.doc.getElementsByTagName("body")[0];
          
          if (destFrame.head) {
            removeNodes(destFrame.head);
          }
          if (destFrame.body) {
            removeNodes(destFrame.body);
          }
          appendNodes(srcFrame.head, destFrame.head);
          appendNodes(srcFrame.body, destFrame.body);
          //call the caller's callback, now that the destFrame is
          //a duplicate of srcFrame
          callback(destFrame);
        });
        
        function removeNodes(node) {
        while (node.firstChild) {
          console.log("Removing: " + node.firstChild.nodeName);
          node.removeChild(node.firstChild);
        }
      }
      function appendNodes(iframe1Node, iframe2Node) {
        var child = iframe1Node.firstChild;
        while (child) {
          if (child.nodeType === Node.ELEMENT_NODE) {
            console.log("Appending: " + child.nodeName);
            
            if (child.nodeName === "SCRIPT") {
              //We need to create the script element the old
              //fashioned way and append it to the DOM for
              //IE to recognize it
              
              var script = destFrame.doc.createElement("script");
              script.type = child.type;
              script.src = child.src;
              
              iframe2Node.appendChild(script);
            } else {
              //Otherwise, we append it the regular way
              //Note the use of importNode(). This is the proper
              //way to copy a node from an external document
              //that can be inserted into the current document
              // https://developer.mozilla.org/en/DOM/document.importNode
              
              iframe2Node.appendChild(destFrame.doc.importNode(child, true));
            }
          }
          
          child = child.nextSibling;
        }
      }
        return frameDuplicate;
      }
      
      function on_load(iframe, callback) {
        if (iframe.addEventListener) {
          iframe.addEventListener("load", callback, false);
        } else {
          iframe.attachEvent("onload", callback);
        }
      }
      
    </script>
  </body>
</html>